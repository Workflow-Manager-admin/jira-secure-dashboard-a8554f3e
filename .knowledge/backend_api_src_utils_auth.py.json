{"is_source_file": true, "format": "Python", "description": "Authentication utilities for JWT token management, password hashing, and secure API token encryption/decryption in a FastAPI backend project.", "external_files": ["jwt", "datetime", "timedelta", "timezone", "typing", "passlib.context", "fastapi", "secrets", "base64", "cryptography.fernet"], "external_methods": ["jwt.encode", "jwt.decode", "jwt.ExpiredSignatureError", "jwt.InvalidTokenError", "secrets.token_urlsafe", "CryptContext.hash", "CryptContext.verify", "Fernet.encrypt", "Fernet.decrypt"], "published": ["create_access_token", "verify_token", "hash_password", "verify_password", "encrypt_api_token", "decrypt_api_token", "generate_session_token"], "classes": [], "methods": [{"name": "str create_access_token(data: Dict[str, Any], expires_delta: Optional[timedelta] = None)", "description": "Creates a JWT token with optional expiration, encoding user data or claims.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,Any] verify_token(token: str)", "description": "Verifies and decodes a JWT token, raising HTTPException if invalid or expired.", "scope": "", "scopeKind": ""}, {"name": "str hash_password(password: str)", "description": "Hashes a plaintext password using bcrypt.\n", "scope": "", "scopeKind": ""}, {"name": "bool verify_password(plain_password: str, hashed_password: str)", "description": "Verifies that a plaintext password matches a hashed password.", "scope": "", "scopeKind": ""}, {"name": "str encrypt_api_token(api_token: str)", "description": "Encrypts a Jira API token securely for storage.", "scope": "", "scopeKind": ""}, {"name": "str decrypt_api_token(encrypted_token: str)", "description": "Decrypts an encrypted Jira API token.", "scope": "", "scopeKind": ""}, {"name": "str generate_session_token()", "description": "Generates a secure random session token string.", "scope": "", "scopeKind": ""}], "calls": ["jwt.encode", "jwt.decode", "pwd_context.hash", "pwd_context.verify", "fernet.encrypt", "fernet.decrypt", "secrets.token_urlsafe"], "search-terms": ["JWT token management", "password hashing", "API token encryption", "secure token generation", "FastAPI security utilities"], "state": 2, "file_id": 9, "knowledge_revision": 18, "git_revision": "", "ctags": [{"_type": "tag", "name": "ACCESS_TOKEN_EXPIRE_MINUTES", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^ACCESS_TOKEN_EXPIRE_MINUTES = int(os.getenv(\"ACCESS_TOKEN_EXPIRE_MINUTES\", \"60\"))$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ALGORITHM", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^ALGORITHM = \"HS256\"$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ENCRYPTION_KEY", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^ENCRYPTION_KEY = os.getenv(\"ENCRYPTION_KEY\", Fernet.generate_key().decode())$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SECRET_KEY", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^SECRET_KEY = os.getenv(\"JWT_SECRET_KEY\", secrets.token_urlsafe(32))$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "create_access_token", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^def create_access_token(data: Dict[str, Any], expires_delta: Optional[timedelta] = None) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data: Dict[str, Any], expires_delta: Optional[timedelta] = None)"}, {"_type": "tag", "name": "decrypt_api_token", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^def decrypt_api_token(encrypted_token: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(encrypted_token: str)"}, {"_type": "tag", "name": "encrypt_api_token", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^def encrypt_api_token(api_token: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(api_token: str)"}, {"_type": "tag", "name": "fernet", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^fernet = Fernet(ENCRYPTION_KEY.encode() if isinstance(ENCRYPTION_KEY, str) else ENCRYPTION_KEY)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "generate_session_token", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^def generate_session_token() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "hash_password", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^def hash_password(password: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(password: str)"}, {"_type": "tag", "name": "pwd_context", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "verify_password", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^def verify_password(plain_password: str, hashed_password: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(plain_password: str, hashed_password: str)"}, {"_type": "tag", "name": "verify_token", "path": "/home/kavia/workspace/code-generation/jira-secure-dashboard-a8554f3e/backend_api/src/utils/auth.py", "pattern": "/^def verify_token(token: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "function", "signature": "(token: str)"}], "hash": "3b04bf62031c86c6adadcdb2e3436079", "format-version": 4, "code-base-name": "backend_api", "filename": "backend_api/src/utils/auth.py", "fields": [{"name": "ACCESS_TOKEN_EXPIRE_MINUTES = int(os.getenv(\"ACCESS_TOKEN_EXPIRE_MINUTES\", \"60\"))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ALGORITHM = \"HS256\"", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ENCRYPTION_KEY = os.getenv(\"ENCRYPTION_KEY\", Fernet.generate_key().decode())", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SECRET_KEY = os.getenv(\"JWT_SECRET_KEY\", secrets.token_urlsafe(32))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "fernet = Fernet(ENCRYPTION_KEY.encode() if isinstance(ENCRYPTION_KEY, str) else ENCRYPTION_KEY)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "pwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"18": ""}]}